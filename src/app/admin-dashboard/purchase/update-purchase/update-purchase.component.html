<div class="p-8 bg-gray-100 min-h-screen">
  <!-- Page Title -->
  <h2 class="text-3xl font-bold text-gray-800 mb-8">Update Purchase</h2>

  <form class="space-y-8 bg-white p-8 rounded-lg shadow-lg" [formGroup]="purchaseForm">

    <!-- Vendor -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
      <div>
        <label class="block text-gray-700 font-medium mb-2">Vendor</label>
        <select formControlName="vendors" [disabled]="true"
          class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
          <option value="">-- Select Vendor --</option>
          <option *ngFor="let vendor of vendors" [ngValue]="vendor.id">{{vendor.name}}</option>
        </select>
      </div>

      <div>
        <label class="block text-gray-700 font-medium mb-2">Invoice No.</label>
        <input type="text" placeholder="INV-2025-001" [value]="invoiceNumber"  [readonly]="readonly"
          class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
      </div>

      <div>
        <label class="block text-gray-700 font-medium mb-2">Date</label>
        <input type="date" formControlName="purchaseDate" [readonly]="readonly"
          class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
      </div>
    </div>

    <!-- Product Table -->
    <div>
      <h3 class="text-xl font-semibold text-gray-700 mb-4">Products</h3>
      <div class="overflow-x-auto">
        <table class="w-full border border-gray-300">
          <thead>
            <tr class="bg-gray-200 text-gray-700 text-left">
              <th class="border px-4 py-2">Product</th>
              <th class="border px-4 py-2">Quantity</th>
              <th class="border px-4 py-2">Price</th>
              <th class="border px-4 py-2">Total</th>
              <th class="border px-4 py-2">Action</th>
            </tr>
          </thead>
          <tbody formArrayName="productsRow">
            <tr *ngFor="let product of purchaseForm.controls.productsRow.controls; let i = index" [formGroupName]="i">
              <td class="border px-4 py-2">
                <select formControlName="product"
                  class="w-full border border-gray-300 rounded px-3 py-2">
                  <option value="">-- Select Product --</option>
                  <option *ngFor="let p of products" [ngValue]="p.id">{{p.name}}</option>
                </select>
              </td>
              <td class="border px-4 py-2">
                <input type="number" placeholder="Qty" formControlName="quantity"
                  (input)="calculateTotalAmount(i)"
                  class="w-full border border-gray-300 rounded px-3 py-2">
              </td>
              <td class="border px-4 py-2">
                <input type="number" placeholder="Price" formControlName="price"
                  (input)="calculateTotalAmount(i)"
                  class="w-full border border-gray-300 rounded px-3 py-2">
              </td>
              <td class="border px-4 py-2">
                <input type="number" formControlName="totalAmount" placeholder="Total" readonly
                  class="w-full border border-gray-300 rounded px-3 py-2 bg-gray-100">
              </td>
              <td class="border px-4 py-2 text-center">
                <button type="button" 
                  class="bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600"
                  (click)="removeProductRow('i')">
                  Remove
                </button>
              </td>
            </tr>
          </tbody>
        </table>
        <button type="button" (click)="addProductRow('i')"
          class="mt-3 bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700">
          + Add Product
        </button>
      </div>
    </div>

    <!-- Grand Total -->
    <div class="flex justify-end items-center mt-6">
      <h3 class="text-xl font-semibold">Grand Total:
        <span class="text-blue-600 font-bold">â‚¹ {{grandTotal}}</span>
      </h3>
    </div>

    <!-- Submit Button -->
    <div class="flex justify-end mt-6">
      <button type="submit" class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700"
        (click)="updateProduct()">
        Update Purchase
      </button>
    </div>
  </form>
</div>
